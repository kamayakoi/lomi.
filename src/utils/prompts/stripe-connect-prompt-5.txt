# Paying Out Money with Stripe Connect

1. **Prerequisites**
   - Register your platform
   - Add business details and complete platform profile
   - Customize brand settings

2. **Set up Stripe**
   - Install Stripe's official libraries:
     ```
     npm install stripe --save
     ```

3. **Create a connected account**
   - Use the `/v1/accounts` API to create a connected account
   - Customize the Express sign-up form in platform settings
   - Prefill account information if available

4. **Create an account link**
   - Use `stripe.accountLinks.create()` with:
     - account
     - refresh_url
     - return_url
     - type = account_onboarding

5. **Handle user redirection**
   - Redirect user to the account link URL
   - Implement `return_url` and `refresh_url` handlers
   - Check `details_submitted` parameter for onboarding completion

6. **Add funds to your balance**
   - Use the Stripe Dashboard to add funds
   - Verify your bank account if necessary
   - Create a top-up using the API:
     ```javascript
     const topup = await stripe.topups.create({
       amount: 2000,
       currency: 'usd',
       description: 'Top-up for week of May 31',
       statement_descriptor: 'Weekly top-up',
     });
     ```

7. **Pay out to your user**
   - Use the API to transfer funds:
     ```javascript
     const transfer = await stripe.transfers.create({
       amount: 1000,
       currency: "eur",
       destination: "{{CONNECTED_STRIPE_ACCOUNT_ID}}",
     });
     ```

8. **Test your integration**
   - Use test bank tokens to simulate various scenarios
   - View account and balance in the Dashboard

9. **Best practices**
   - Use manual payout schedule when adding funds
   - Secure account link URLs within your application
   - Always use HTTPS for `return_url` and `refresh_url` in live mode
   - Check account status after onboarding completion

10. **Additional considerations**
    - Settlement timing varies (5-6 business days for US platforms via ACH)
    - Customize statement descriptors for clarity
    - Monitor and adjust payout schedules as needed

Remember to thoroughly test your integration in test mode before processing real transactions and payouts.